!function(exports,global){global["true"]=exports;var HackerNews=angular.module("app",[]);HackerNews.service("URLProvider",function(){var baseAPI="https://hacker-news.firebaseio.com/v0/",baseHN="https://news.ycombinator.com/";this.item=function(id){return baseAPI+"item/"+id},this.top=function(){return baseAPI+"topstories"},this.view=function(id){return baseHN+"item?id="+id},this.vote=function(id){return baseHN+"vote?for="+id+"&dir=up&whence=news"}}),HackerNews.service("APIWrapper",function($window,$q){this.fetch=function(url){var connection,onValue;return $q(function(resolve,reject){connection=new $window.Firebase(url),onValue=connection.on("value",function(snapshot){resolve(snapshot),connection.off("value",onValue)},reject)})},this.disconnect=function(){$window.Firebase.goOffline()}}),HackerNews.service("TopStories",function($q,APIWrapper,URLProvider){function fetchTop(onStory,onDone,onError){APIWrapper.fetch(URLProvider.top()).then(function(snapshot){var promises=[];angular.forEach(snapshot.val(),function(id){var promise=$q(function(resolve){fetchStory(id,resolve)});promise.then(onStory),promises.push(promise)}),$q.all(promises).then(onDone).catch(onError)}).catch(onError)}function fetchStory(id,onStory){APIWrapper.fetch(URLProvider.item(id)).then(function(snapshot){var story=snapshot.val();story.date=new Date(1e3*story.time),story.text&&(story.url=URLProvider.view(story.id)),onStory(story)})}this.each=function(onStory){return $q(function(resolve,reject){fetchTop(function(story){onStory(story)},resolve,reject)})},this.disconnect=function(){APIWrapper.disconnect()}}),HackerNews.controller("TopStoriesCtrl",function($scope,TopStories){$scope.status="Loading",$scope.stories=[],TopStories.each(function(story){$scope.stories.push(story)}).then(function(){TopStories.disconnect()}).catch(function(){$scope.status="Error loading stories",console.log("The API returned an error")})}),HackerNews.filter("domain",function(){return function(url){var a=document.createElement("a");return a.href=url,a.hostname}})}({},function(){return this}());
//# sourceMappingURL=app.min.js.map